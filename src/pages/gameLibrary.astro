---
import Layout from '~/layouts/PageLayout.astro';
// import Footer from '~/components/widgets/Footer.astro';
// 使用 Astro 的 fetch 方法（服务端）
const gameListRes = await fetch('https://apifoxmock.com/m1/5804244-5489264-default/gameList');
const gameListResult = await gameListRes.json();
const gameList = gameListResult.data || [];

const mirrorListRes = await fetch('https://apifoxmock.com/m1/5804244-5489264-default/mirror');
const mirrorListResult = await mirrorListRes.json();
const mirrorList = mirrorListResult.data || [];

const peopleListRes = await fetch('https://apifoxmock.com/m1/5804244-5489264-default/peopleNum');
const peopleListResult = await peopleListRes.json();
const peopleList = peopleListResult.data || [];

const morePeopleListRes = await fetch('https://apifoxmock.com/m1/5804244-5489264-default/morePeople');
const morePeopleListResult = await morePeopleListRes.json();
const morePeopleList = morePeopleListResult.data || [];
---

<Layout showHeader={false} showFooter={true}>
  <div
    class="bg-gray-100"
    style="padding-top: 56.25%;background: linear-gradient(0deg, rgba(33, 29, 27, 0) 47.47%, rgba(255, 255, 255, 1) 100%, rgba(105, 101, 100, 0.5) 100%);"
  >
    <!-- 背景图层，应用背景模糊 -->
    <div
      class="absolute inset-0 bg-[url('/assets/images/默认选购.png')] bg-cover bg-no-repeat bg-center z-[-1]"
      style="filter: blur(0.52vw);"
    >
    </div>

    <!-- 吸附在顶部的导航栏  h-[51.5vw] -->
    <div
      id="scrollableDiv"
      class="fixed flex justify-between items-center top-0 left-0 w-full h-[4.17vw] pr-[8.3333vw] pl-[7.1875vw] bg-white bg-opacity-30 z-50"
      style="background:rgba(51, 51, 51, .3)"
    >
      <div><img src="/assets/images/FFGameCloud-logo.png" class="w-[8.75vw] h-[2.08vw]" alt="" /></div>
      <div
        class="control-btn w-[6.25vw] h-[2.34vw] cursor-pointer flex justify-between items-center px-[0.8333vw] py-[0.625vw] group relative"
      >
        <div style="font-size: 0.73vw;color:#ffffff">控制台</div>
        <div><img src="/assets/images/控制台圆形.png" alt="" class="w-[1.4583vw] h-[1.4583vw]" /></div>

        <!-- 菜单 -->
        <div
          class="absolute menu top-[120%] left-1/2 transform -translate-x-1/2 mt-[1.15vw] hidden group-hover:block group-focus-within:block focus-within:block shadow-lg rounded-[0.26vw]"
        >
          <ul
            class="text-sm w-[12.0417vw] rounded-[0.2604vw] border-solid border-[rgba(0,_0,_0,_0.1)] backdrop-blur-[0.1vw] bg-[rgba(0,_0,_0,_0.4)]"
          >
            <li class="h-[2.5vw] flex items-center hover:bg-[rgba(255,_255,_255,_0.5)]">
              <img
                src="/assets/images/usericon.svg"
                class="w-[1.3542vw] h-[1.3542vw] ml-[0.625vw] mr-[0.5729vw]"
                alt=""
              />
              <div class="flex flex-col justify-center">
                <span style="font-size: 0.625vw; line-height: 1;color:#ffffff">桃子</span>
                <span style="font-size: 0.5208vw; color: rgba(148, 148, 148, 1); line-height: 1;">54564654@qq.com</span>
              </div>
            </li>
            <li class="h-[2.5vw] flex items-center hover:bg-[rgba(255,_255,_255,_0.5)]" style="">
              <img
                src="/assets/images/cashicon.svg"
                class="w-[0.78125vw] h-[0.78125vw] ml-[0.83vw] mr-[0.3646vw]"
                alt=""
              />
              <div class="flex flex-col justify-center">
                <div class="flex items-center" style="font-size: 0.625vw; line-height: 1;color:rgba(148, 148, 148, 1)">
                  <span>账户余额</span>
                  <div class="flex items-center justify-between ml-[1.875vw]">
                    <span style="font-size: 0.7292vw;color:rgba(255, 255, 255, 1)">￥0.00</span>
                    <img src="/assets/images/righticon.svg" class="w-[0.78125vw] h-[0.78125vw] ml-[2.1875vw]" alt="" />
                  </div>
                </div>
              </div>
            </li>
            <li class="h-[2.5vw] flex items-center hover:bg-[rgba(255,_255,_255,_0.5)]">
              <img
                src="/assets/images/settingicon.svg"
                class="w-[0.78125vw] h-[0.78125vw] ml-[0.83vw] mr-[0.3646vw]"
                alt=""
              />
              <div class="flex items-center">
                <div style="font-size: 0.625vw; line-height: 1;color:rgba(148, 148, 148, 1)">账户设置</div>
                <img src="/assets/images/righticon.svg" class="w-[0.78125vw] h-[0.78125vw] ml-[6.2vw]" alt="" />
              </div>
            </li>
            <li
              id="logout"
              class="h-[2.5vw] flex items-center justify-center text-center"
              style="border-top: 1px solid rgba(148, 148, 148, 1);font-size: 0.625vw;color:rgba(186, 179, 179, 1)"
            >
              <span style="color: 0.72vw; font-size: rgba(186, 179, 179, 1);">退出登录</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="absolute z-10 top-[4.17vw] max-h-fit w-full">
      <div
        class="mt-[3.98vw] ml-[8.39vw] w-[15.1vw] h-[1.8vw] rounded-full flex items-center pl-[0.52vw] cursor-pointer transition-all duration-[1000ms] ease-[cubic-bezier(0.4, 0, 1, 1)] hover:ml-[10.39vw]"
        style="font-size: 0.52vw; background-color: rgba(5, 0, 0, 0.3);"
      >
        <span style="color: rgba(242, 106, 22, 1); opacity: 1;">免费</span>
        <span style="color: #FFFFFF; opacity: 1;">为您的所有文件和数据从您的旧主机迁移到我们这里！</span>
      </div>

      <div
        class="mt-[0.46875vw] ml-[8.39vw] mb-[2.11vw] w-[7.08vw] h-[1.8vw] rounded-full flex items-center pl-[0.52vw] cursor-pointer transition-all duration-[1000ms] ease-[cubic-bezier(0.4, 0, 1, 1)] hover:ml-[10.39vw]"
        style="font-size: 0.52vw; background-color: rgba(5, 0, 0, 0.3);"
      >
        <span style="color: #FFFFFF; opacity: 1;">可享专业在线客服</span>
        <span style="color: rgba(242, 106, 22, 1); opacity: 1;">协助 +</span>
      </div>
      <!-- 游戏 -->
      <div class="w-[87.04vw] h-[30.89vw] ml-[4.43vw]">
        <div class="w-[87.04vw] flex justify-between bg-[#b1e49300]">
          <div class="card-stack-container" style="position: relative; width: 62.5vw; height: 26.3vw;">
            {
              gameList.map((game, index) => (
                //堆叠
                <div
                  class="card-stack"
                  id="cardStack"
                  data-id={game.id}
                  style={`position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                       transform: translateY(${index * 5}px); 
                       transition: all 0.3s ease; z-index: ${gameList.length - index}; transform: scale(${1 - index * 0.001})`}
                >
                  <div class="w-[62.5vw] h-[26.3vw] pt-[3.13vw] flex mr-[2.31vw]" key={game.id} style="">
                    <div class="w-[17.29vw] h-[24.65vw] relative" style="border-radius: 0.26vw 0px 0px 0.26vw;">
                      <img src={game.sImage} alt="" srcset="" class="w-[17.29vw] h-[24.65vw] absolute z-0" />
                      <div class="w-[17.29vw] h-[24.65vw] absolute z-10 bg-[#0D010110] backdrop-blur-[1vw]">
                        <div
                          class="h-[1.71875vw] w-[2.03125vw] ml-[1.8229vw] p-[0.2604vw] bg-[#F26A16]"
                          style="border-radius: 0vw 0vw 0.2604vw 0.2604vw;font-size: 0.7292vw;color:#FFFFFF;"
                        >
                          推荐
                        </div>
                        <div
                          class="ml-[1.8229vw] mt-[1.40625vw]"
                          style="font-size: 1.5625vw;font-weight: 400;color:#FFFFFF;"
                        >
                          {game.name}
                        </div>
                        <div
                          class="mt-[0.2083vw] ml-[12.08vw] text-white w-[3.6458vw] h-[1.5625vw] flex justify-center items-center cursor-pointer border-[0.0521vw] border-[#FFFFFF] rounded-[0.2604vw] transition-all hover:border-[#f56a1f] hover:text-[#f56a1f]"
                          style="font-size: 0.625vw;"
                        >
                          下载游戏
                        </div>

                        <div
                          class="w-[13.94vw] h-[4.89vw] ml-[1.8229vw] mt-[1.5625vw]"
                          style="font-size: 0.625vw;line-height:0.90625vw;color:#FFFFFF;"
                        >
                          {game.descTxt}
                        </div>
                        <div
                          class="mt-[1.5vw] ml-[1.8229vw]"
                          style="font-size: 0.7292vw; color:#f56a1f;line-height: 20.27px;"
                        >
                          开服价：{game.price}元/月起
                        </div>
                        <div class="mt-[1.9792vw] ml-[1.8229vw]" style="font-size: 0.625vw;color:#FFFFFF;">
                          操作方式
                        </div>
                        <div class="flex items-center mt-[0.52vw]">
                          <img
                            src="/assets/images/pc-icon.svg"
                            alt=""
                            class="ml-[3.28125vw] w-[1.46vw] h-[1.67vw] cursor-pointer"
                          />
                          <img
                            src="/assets/images/手机.svg"
                            alt=""
                            class="ml-[1.5vw] w-[1.41vw] h-[1.56vw] cursor-pointer"
                          />
                          <img
                            src="/assets/images/switch-filled.svg"
                            alt=""
                            class="ml-[1.5vw] w-[1.6667vw] h-[1.71875vw] cursor-pointer"
                          />
                          <img
                            src="/assets/images/steam2.svg"
                            alt=""
                            class="ml-[1.93vw] w-[1.3vw] h-[1.3vw] cursor-pointer"
                          />
                        </div>
                      </div>
                    </div>
                    <div class="w-[45.21vw] h-[24.65vw]" style="border-radius: 0px 0.26vw 0.26vw 0px;">
                      <img src={game.bImage} alt="" srcset="" class="w-[45.21vw] h-[24.65vw]" />
                    </div>
                  </div>
                </div>
              ))
            }
          </div>
          <div class="w-[22.2vw] h-[30.89vw] overflow-y-scroll overflow-hidden custom-scrollbar-hidden bg-[#ffffff00]">
            <!-- 开服游戏列表 -->
            <div id="section1">
              <div class="h-[3.17vw]">
                <span style="color:rgba(255, 255, 255, 1); font-size: 0.88vw;">游戏：</span>
                <span style="color: rgba(148, 148, 148, 100); font-size: 0.88vw;">你想开服的游戏是？</span>
              </div>

              {
                gameList.map((game, index) => (
                  <div
                    key={index}
                    key={game.id}
                    data-id={game.id}
                    data-name={game.name}
                    data-desc={game.descTxt}
                    data-price={game.price}
                    data-bImage={game.bImage}
                    data-sImage={game.sImage}
                    data-target="#section2"
                    class="game-item w-[22.2vw] h-[5.1vw] pl-[2vw] pr-[1.1vw] flex justify-between items-center cursor-pointer mb-[1.354vw]"
                    style="background: linear-gradient(270deg, #00000030 36.62%, #403D3D30 100%); border: 0.05208vw solid #B0A29E; border-radius: 0vw;"
                  >
                    <div>
                      <div style="font-size: 0.89vw; color:#FFFFFF" class="mb-[0.678vw]">
                        {game.name}
                      </div>
                      <div style="font-size: 0.57vw;" class="flex">
                        {game.tags.map((tag, tagIndex) => (
                          <div
                            key={tagIndex}
                            class="w-[3.23vw] h-[1.04vw] text-center leading-[1.04vw] rounded-full text-[#F26A16] bg-[#2E2522] mr-[0.5208vw] flex items-center justify-center"
                          >
                            {tag}
                          </div>
                        ))}
                      </div>
                    </div>
                    <img src={game.gameLogo} class="w-[3vw] h-[3vw]" alt={`${game.name} logo`} />
                  </div>
                ))
              }
              <div
                class="w-[22.2vw] h-[5.1vw] pl-[2vw] pr-[1.1vw] flex justify-between items-center cursor-pointer mt-[1.354vw]"
                style="border: 0.05208vw solid #B0A29E00;border-radius: 0vw;background: rgba(82, 66, 66, 1);"
              >
                <div>
                  <div style="font-size: 0.89vw;color:#FFFFFF;margin-bottom: 0.31vw;">需要协助选择游戏?</div>
                  <div style="font-size: 0.57vw;color:#FFFFFF;">了解不同服务器型号和性能的区别。</div>
                </div>
                <img src="/assets/images/gamelogo.png" class="w-[3vw] h-[3vw]" alt="" srcset="" />
              </div>
            </div>
            <!-- 协助区域 -->
            <!-- <div>
              <div
                class="w-[22.2vw] h-[5.1vw] pl-[2vw] pr-[1.1vw] flex justify-between items-center cursor-pointer mt-[1.354vw]"
                style="border: 0.05208vw solid #B0A29E00;border-radius: 0.26vw;background: rgba(82, 66, 66, 1);"
              >
                <div>
                  <div style="font-size: 0.89vw;color:#FFFFFF;margin-bottom: 0.31vw;">需要协助选择游戏?</div>
                  <div style="font-size: 0.57vw;color:#FFFFFF;">了解不同服务器型号和性能的区别。</div>
                </div>
                <img src="/assets/images/gamelogo.png" class="w-[3vw] h-[3vw]" alt="" srcset="" />
              </div>
            </div> -->
            <!-- 镜像区域 -->
            <div class="mt-[2.239vw]" id="section2">
              <div class="h-[3.17vw]">
                <span style="color:rgba(255, 255, 255, 1); font-size: 0.88vw;">镜像：</span>
                <span style="color: rgba(148, 148, 148, 100); font-size: 0.88vw;">你想镜像的类型是？</span>
              </div>
              {
                mirrorList?.map((mirror, mirrorIndex) => (
                  <div
                    data-id={mirror.id}
                    data-target="#section3"
                    class="mirror-item w-[22.2vw] h-[5.1vw] pl-[2vw] pr-[1.1vw] flex justify-between items-center cursor-pointer mb-[1.354vw]"
                    style="background: linear-gradient(270deg, #000000FF 36.62%, #403D3DFF 100%); border: 0.05208vw solid #B0A29E; border-radius: 0vw;"
                  >
                    <div style="">
                      <div class="mb-[0.678vw]">
                        <span style="font-size: 0.89vw; color:#FFFFFF">
                          {mirror.name}
                          {mirror.server}
                        </span>
                      </div>
                      <div style="font-size: 0.57vw;" class="flex">
                        {mirror.tags.map((tag, tagIndex) => (
                          <div
                            key={tagIndex}
                            className={`w-[3.23vw] h-[1.04vw] text-center leading-[1.04vw] rounded-full mr-[0.5208vw] flex items-center justify-center
      ${tagIndex === 0 ? 'bg-[#2E2522] text-[#BA7245]' : 'bg-[#302B29] text-[#706C6B]'}`}
                          >
                            {tag}
                          </div>
                        ))}
                      </div>
                    </div>
                    <div class=" text-[#FF8D1A] " style="font-size: 0.73vw;">
                      {mirror.price}R/月起
                    </div>
                  </div>
                ))
              }
            </div>
            <!-- 人数套餐区域 -->
            <div class="mt-[2.239vw]" id="section3">
              <div class="h-[3.17vw]">
                <span style="color:rgba(255, 255, 255, 1); font-size: 0.88vw;">人数：</span>
                <span style="color: rgba(148, 148, 148, 100); font-size: 0.88vw;">你想游玩的人数？</span>
              </div>
              {
                peopleList?.map((people) => (
                  <div
                    data-id={people.id}
                    class="people-item w-[22.2vw] h-[5.1vw] pl-[2vw] pr-[1.1vw] flex justify-between items-center cursor-pointer mb-[1.354vw]"
                    style="background: linear-gradient(270deg, #000000FF 36.62%, #403D3DFF 100%);; border: 0.05208vw solid #B0A29E; border-radius: 0vw;"
                  >
                    <div style="">
                      <div class="mb-[0.678vw]">
                        <span style="font-size: 0.89vw; color:#FFFFFF">{people.num}人组队</span>
                      </div>
                    </div>
                    <div class=" text-[#FF8D1A] " style="font-size: 0.73vw;">
                      {people.price}R/月起
                    </div>
                  </div>
                ))
              }
              <div
                class="more-people-item w-[22.2vw] h-[5.1vw] pl-[2vw] pr-[1.1vw] flex justify-between items-center cursor-pointer mb-[1.354vw]"
                style="background: linear-gradient(270deg, #000000 36.62%, #403D3D 100%); border: 0.05208vw solid #B0A29E; border-radius: 0.26vw;"
              >
                <div style="">
                  <div class="mb-[0.678vw]">
                    <span style="font-size: 0.89vw; color:#FFFFFF"> 更多套餐 </span>
                  </div>
                </div>
                <div class="text-[#FF8D1A]" style="font-size: 0.73vw;">
                  <div class="select-container">
                    <div class="custom-select-wrapper">
                      <div class="custom-select" id="teamSizeSelect">
                        <div
                          class="selected-option flex justify-between items-center"
                          style="border-bottom: 0.052vw solid #363332;"
                        >
                          <div class="text-[#C9C9C9]" style="font-size:0.729vw" id="moreSelete">组队人数</div>
                          <img src="/assets/images/下箭头.svg" alt="" class="w-[0.625vw] h-[0.625vw]" />
                        </div>
                        <ul class="options-list">
                          {
                            morePeopleList?.map((more) => (
                              <li
                                class="option-item"
                                key={more.num}
                                data-num={more.num}
                                data-price={more.price}
                                data-id={more.id}
                              >
                                <span class="text-[#ffffff]">{more.num}人</span>
                                <span class="text-[#FF8D1A]">{more.price}元/月</span>
                              </li>
                            ))
                          }
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div>
    <div class="w-full h-[12.08vw] flex justify-center items-center" id="section4">
      <div class="w-[78.07vw] h-[12.08vw]">
        <div class="h-[2.862vw]" style="font-size: 0.9375vw;">
          <span class="text-[#FFFFFF]">NAT或升级独立IP模式：</span><span class="text-[#949494]">你想选择的是？</span>
        </div>
        <div class="flex justify-between">
          <!-- 是否升级独立IP -->
          <div class="w-[47.44vw] h-[9.218vw] flex justify-between">
            <!-- 升级独立IP -->
            <div
              id="upIpAddr"
              class="w-[22.39vw] h-[9.218vw] bg-[#211d1b00] px-[0.83vw] cursor-pointer"
              style="border-radius: 0vw;border:0.052vw solid #474141FF"
            >
              <div
                class="h-[2.68vw] text-[#949494] flex items-center justify-center mb-[0.859vw]"
                style="border-bottom: 0.052vw solid #474141;font-size: 0.78vw;"
              >
                升级独立IP
              </div>
              <div class="h-[6.538vw] text-[#949494]" style="font-size: 0.52vw;">
                <p style="line-height: 0.78vw;margin-bottom: 0.39vw;">
                  1.
                  升级独立IP地址即为服务器开通单独IP，单独IP具有一定的防御攻击能力，以及可以直接用IP进行公网访问，适用于网站等各种业务
                </p>
                <p style="line-height: 0.78vw;margin-bottom: 0.39vw;">2. 购买后可随时按需要加购或删除不同类型的IP</p>
                <p style="line-height: 0.78vw;margin-bottom: 0.39vw;">
                  3.
                  如不升级独立IP（NAT模式）则默认为共享IP，该模式下如需访问公网，可使用NAT功能对外映射端口，适用于内网穿透，游戏开服，研究学习等业务，后续有需要可增购IP地址。
                </p>
              </div>
            </div>
            <!-- 不升级独立IP -->
            <div
              id="noUpIpAddr"
              class="w-[22.39vw] h-[9.218vw] flex items-center justify-center bg-[#211d1b00] cursor-pointer text-[#FFFFFF]"
              style="border-radius: 0vw;font-size: 0.78vw;border:0.052vw solid #474141FF"
            >
              不升级独立IP
            </div>
          </div>
          <!-- 如何升级IP -->
          <div class="w-[25.99vw] h-[9.218vw] cursor-pointer flex" style="border-radius: 0.169vw;background: #524242;">
            <div class="w-[10.76vw] h-[9.218vw]" style="background-color: #FFFFFF30;border-radius: 0.169vw;"></div>
            <div class="w-[15.23vw] h-[9.218vw] pt-[0.885vw] flex justify-around" style="background-color: #FFFFFF00;">
              <div class="w-[9.16vw] h-[2.44vw]">
                <div style="color: #FFFFFF;font-size: 0.78vw;margin-bottom: 0.468vw;">如何进行升级ip?</div>
                <div style="color: #ADA5A3;font-size: 0.57vw;">了解不同服务器型号和性能的区别。</div>
              </div>
              <div>
                <img src="/assets/images/加号.svg" class="w-[0.729vw] h-[0.729vw] rotate-add-icon" alt="" srcset="" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="section5" class="w-[77.4vw] mx-auto flex pt-[9.33vw]">
    <div
      class="mb-[49.11vw] w-[77.4vw] h-[32.03vw] bg-[#211d1b] mx-auto flex"
      style="border:1px solid #000000;border-radius: 0.52vw;"
    >
      <div class="w-[33.125vw] h-[31.926vw]" style="border-radius:  0.52vw 0 0  0.52vw;">
        <div
          class="w-[33.125vw] h-[10.836vw] text-[#FFFFFF] flex justify-center items-center"
          style="font-size: 1.82vw;"
        >
          <div class="w-[18.22vw] text-center">一键开服，畅快开黑， 自动部署，开箱即用。</div>
        </div>
        <div class="h-[21.09vw] w-[33.125vw] relative" style="border-radius:0  0.52vw 0  0.52vw ;">
          <img
            src="/assets/images/默认选购.png"
            class="h-[21.09vw] w-[33.125vw]"
            style="border-radius:0  0.52vw 0  0.52vw ;"
            id="currPickBigImg"
          />
          <div
            class="absolute bg-[#00000060] text-[#FFFFFF] h-[2.86vw] right-0 bottom-[1.15vw] px-[1.718vw] py-[0.885vw] flex justify-between items-center"
            style="min-width: 14.53vw; backdrop-filter: blur(0.26vw);border-radius: 0.26vw 0px 0px 0.26vw;font-size: 0.729vw;"
          >
            <span id="currPickGame" class="mr-[2.29vw]">未选择游戏</span>
            <span id="currPickMirror" class="mr-[2.29vw]">未选择镜像</span>
            <span id="currPickPeople">未选择人数</span>
          </div>
        </div>
      </div>
      <div class="w-[23.02vw] h-[31.926vw] pt-[0.83vw] pl-[2.239vw] pr-[2.913vw] flex flex-col items-center">
        <div class="relative">
          <img
            src="https://img.js.design/assets/img/677931ca19abf04c14afb242.jpg#42e81b8418873d43f430893f2d85b759"
            class="w-[17.86vw] h-[9.11vw] rounded-[0.289vw]"
            alt=""
            id="currPickSmallImg"
          />
          <div
            class="absolute inset-0 flex items-center justify-center flex-col text-[#CFCCCC] font-semibold"
            style="font-size: 0.729vw;"
          >
            <span style="font-size:0.83vw ;color:#ffffff;margin-bottom:2vw">购买说明</span><span>购买后3分钟内可用</span
            ><span>需要协助或有疑问可联系官方客服</span>
          </div>
          <div class="w-[17.86vw] h-[9.11vw] rounded-[0.289vw] absolute bg-[#8b8b8b80] top-0"></div>
        </div>
        <div
          class="h-[13.125vw] w-[13.80vw] mt-[3.90vw] flex items-center justify-center flex-col"
          style="border-bottom: 0.052vw solid #474141;border-top: 0.052vw solid #474141;"
        >
          <div class="w-[13.75vw] h-[4.01vw] mb-[1.822vw] relative">
            <div style="font-size: 0.833vw; color:#BAB3B3">周期</div>
            <div
              class="dropdown w-[13.75vw] h-[2.395vw] bg-[#3B3130] px-[1.362vw] py-[0.572vw] flex items-center justify-between"
              style="border: 0.052vw solid #61504E;font-size: 0.833vw;color:#ffffff"
            >
              <div id="selectedPeriod">1月</div>
              <img src="/assets/images/三角形箭头.svg" alt="" class="w-[0.64vw] h-[0.52vw]" />
            </div>
            <!-- 下拉菜单 -->
            <div
              id="dropdownMenu"
              class="dropdown-menu w-[13.75vw] bg-[#3B3130] mt-[0.5vw] opacity-0 scale-95 transform transition-all duration-300"
              style="display: none;"
            >
              <div class="dropdown-item" data-cycle="1">1月</div>
              <div class="dropdown-item" data-cycle="3">3月</div>
              <div class="dropdown-item" data-cycle="6">6月</div>
              <div class="dropdown-item" data-cycle="12">12月</div>
              <div class="dropdown-item" data-cycle="24">24月</div>
              <div class="dropdown-item" data-cycle="36">36月</div>
            </div>
          </div>
          <div class="w-[13.75vw] h-[4.01vw]">
            <div style="font-size: 0.833vw; color:#BAB3B3">优惠码</div>
            <div
              class="w-[13.75vw] h-[2.395vw] flex justify-between items-center bg-[#3B3130]"
              style="border: 0.052vw solid #61504E;"
            >
              <!-- <div style="font-size: 0.833vw; color:#fff;" class="pl-[1.362vw]">验证码内容</div> -->
              <input
                required=""
                class="bg-transparent text-[#fff] px-3 py-1 focus:outline-none w-full"
                id="promoCode"
                name="text"
                type="text"
                autocomplete="off"
                style="font-size: 0.833vw;"
              />
              <div
                class="w-[3.90vw] h-[1.04vw] flex justify-center items-center cursor-pointer"
                style="border-left: 0.052vw solid #61504E;font-size: 0.833vw; color:#fff;"
                id="verifPpromoCode"
              >
                验证
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="w-[21.225vw] h-[31.926vw] flex flex-col items-center">
        <div class="h-[8.80vw] w-[17.5vw] pt-[2.256vw]" style="border-bottom:0.052vw solid #474141">
          <div class="text-[#BAB3B3] mb-[0.989vw]" style="font-size: 0.83vw;">价格</div>
          <div class="text-[#F26A16] w-[17.5vw] flex justify-center items-baseline" style="font-weight: 700;">
            <span style="font-size: 1.25vw;margin-right:0.25vw">¥</span><span style="font-size: 2.39vw;" id="payAmount"
              >0</span
            >
          </div>
        </div>
        <div class="mt-[3.80vw] w-[19.0vw]">
          <div
            data-payType="aliPay"
            class="payment-method w-[18.33vw] h-[3.07vw] p-[0.52vw] flex items-center justify-between cursor-pointer"
          >
            <div class="flex items-center">
              <img src="/assets/images/ali_pay.svg" alt="" class="w-[1.979vw] h-[1.979vw]" />
              <div class="ml-[1.093vw] text-white" style="font-size:0.833vw">支付宝</div>
            </div>
            <img src="/assets/images/no_select_pay_type.svg" alt="" class="w-[1.25vw] h-[1.25vw] isselect" />
          </div>
          <div
            data-payType="wxPay"
            class="payment-method w-[18.33vw] h-[3.07vw] p-[0.52vw] flex items-center justify-between cursor-pointer"
          >
            <div class="flex items-center">
              <img
                src="/assets/images/wx_pay.svg"
                alt=""
                class="w-[1.979vw] h-[1.979vw] bg-[#fff]"
                style="border-radius: 0.52vw;"
              />
              <div class="ml-[1.093vw] text-white" style="font-size:0.833vw">微信支付</div>
            </div>
            <img src="/assets/images/no_select_pay_type.svg" alt="" class="w-[1.25vw] h-[1.25vw] isselect" />
          </div>
          <div
            data-payType="balancePay"
            class="payment-method w-[18.33vw] h-[3.07vw] p-[0.52vw] flex items-center justify-between cursor-pointer"
          >
            <div class="flex items-center">
              <img src="/assets/images/balance_pay.svg" alt="" class="w-[1.979vw] h-[1.979vw]" />
              <div class="ml-[1.093vw] text-white" style="font-size:0.833vw">余额</div>
            </div>
            <img src="/assets/images/no_select_pay_type.svg" alt="" class="w-[1.25vw] h-[1.25vw] isselect" />
          </div>
        </div>

        <div
          id="paymentBtn"
          class="w-[17.39vw] mt-[4vw] h-[4.479vw] flex justify-center items-center text-white cursor-pointer
        transition-colors duration-1000 ease-in-out
        rounded-[0.461vw]
        bg-gradient-to-r from-[#1C80EB] to-[#40C6FF] hover:bg-gradient-to-r hover:from-[#008df7] hover:to-[#40C6FF]"
        >
          立即付款
        </div>
      </div>
    </div>
    <div id="message-container" class="space-y-2 p-4" style="display: none;">
      <div
        id="success-message"
        class="message bg-green-100 text-green-900 p-2 rounded-[0.3vw] flex items-center justify-center transition duration-300 ease-in-out transform opacity-0"
      >
        <svg
          t="1740156480442"
          class="icon"
          viewBox="0 0 1075 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="5727"
          width="16"
          height="16"
          ><path
            d="M541.3376 0c-282.7776 0-512 229.2224-512 512s229.2224 512 512 512 512-229.2224 512-512-229.2224-512-512-512z m290.7648 400.7424l-336.384 340.6336a53.76 53.76 0 0 1-76.8 0L259.584 579.9936a55.3984 55.3984 0 0 1 0-77.6704 53.76 53.76 0 0 1 76.7488 0l120.9856 122.5216 298.0352-301.824a53.76 53.76 0 0 1 76.7488 0 55.4496 55.4496 0 0 1 0 77.7216z"
            fill="#35B262"
            p-id="5728"></path></svg
        >
        <p class="text-xs font-semibold mx-[1vw]">Success - Everything went smoothly!</p>
      </div>

      <div
        id="info-message"
        class="message bg-blue-100 text-blue-900 p-2 rounded-lg flex items-center transition duration-300 ease-in-out transform opacity-0"
      >
        <svg class="h-5 w-5 flex-shrink-0 mr-2 text-blue-600">
          <path
            d="M13 16h-1v-4h1m0-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            stroke-width="2"
            stroke-linejoin="round"
            stroke-linecap="round"></path>
        </svg>
        <p class="text-xs font-semibold">Info - This is some information for you.</p>
      </div>

      <div
        id="warning-message"
        class="message bg-yellow-100 text-yellow-900 p-2 rounded-[0.3vw] flex items-center justify-center transition duration-300 ease-in-out transform opacity-0"
      >
        <svg
          t="1740157266062"
          class="icon"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="10892"
          width="16"
          height="16"
          ><path
            d="M511.857817 0a511.857817 511.857817 0 1 0 511.857818 511.857817 511.857817 511.857817 0 0 0-511.857818-511.857817z m0 813.285199a60.569842 60.569842 0 0 1 0-120.855318 60.569842 60.569842 0 1 1 0 120.855318z m36.398778-211.567898a36.967509 36.967509 0 0 1-72.51319 0l-24.171064-325.882811A61.991669 61.991669 0 0 1 511.857817 209.57734a60.569842 60.569842 0 0 1 60.569842 60.285476z"
            fill="#e8a245"
            p-id="10893"></path></svg
        >
        <p class="text-xs font-semibold mx-[1vw]">Warning - Be careful with this next step.</p>
      </div>

      <div
        id="error-message"
        class="message bg-red-100 text-red-900 p-2 rounded-[0.3vw] flex items-center justify-center transition duration-300 ease-in-out transform opacity-0"
      >
        <svg
          t="1740157046834"
          class="icon"
          viewBox="0 0 1075 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="7013"
          width="16"
          height="16"
          ><path
            d="M519.168 0C236.544 0 7.4752 229.0688 7.4752 511.6928s229.12 511.6928 511.6928 511.6928c282.624 0 511.6928-229.12 511.6928-511.6928C1030.8608 229.0688 801.792 0 519.168 0z m203.1616 664.1152a35.84 35.84 0 0 1-50.7904 50.688l-152.1664-152.1152-152.1152 152.1152a35.84 35.84 0 0 1-50.7904-50.688l152.2688-152.2176-152.2688-152.2176a35.84 35.84 0 1 1 50.7904-50.688l152.1664 152.1664 152.2176-152.1664a35.8912 35.8912 0 0 1 50.688 50.688l-152.2176 152.2176 152.2176 152.2176z"
            fill="#FA6565"
            p-id="7014"></path></svg
        >
        <p class="text-xs font-semibold mx-[1vw]">Error - Something went wrong.</p>
      </div>
    </div>
    <!-- <div id="wxPayBox" class="fixed">
      <img src="/assets/images/wxpay.JPG" alt="" srcset="" class="w-[10vw] h-[10vw]"/>
    </div>
    <div id="aliPayBox" class="fixed">
      <img src="/assets/images/alipay.JPG" alt="" srcset="" class="w-[10vw] h-[10vw]"/>
    </div> -->
  </div>
</Layout>
<script define:vars={{ gameList, mirrorList, peopleList, morePeopleList }}>
  console.log('服务端>游戏列表数据:', gameList);
  console.log('服务端>镜像列表数据:', mirrorList);
  console.log('服务端>人数列表数据:', peopleList);
  console.log('服务端>(更多)人数列表数据:', morePeopleList);
  window.onload = function () {
    window.scroll({ top: 0, left: 0, behavior: 'smooth' }); // 以平滑的方式滚动到页面顶部
  };
  // 禁止 F12
  // document.addEventListener('keydown', function (event) {
  //   if (event.keyCode === 123) {
  //     // F12 键
  //     event.preventDefault();
  //     showMessage({
  //       msg: '禁止使用开发者工具！',
  //       duration: 3000,
  //       type: 'warning',
  //     });
  //   }
  // });

  // // 禁止右键菜单
  // document.addEventListener('contextmenu', function (event) {
  //   event.preventDefault(); // 禁止右键菜单
  //   // alert('右键功能已禁用！');
  //   showMessage({
  //     msg: '右键功能已禁用！',
  //     duration: 3000,
  //     type: 'warning',
  //   });
  // });

  // 获取目标元素
  const scrollableDiv = document.getElementById('scrollableDiv');
  const currPickGame = document.getElementById('currPickGame'); //显示选中游戏名称元素
  const currPickBigImg = document.getElementById('currPickBigImg'); //显示选中游戏大图元素
  const currPickSmallImg = document.getElementById('currPickSmallImg'); //显示选中游戏小图元素
  const currPickMirror = document.getElementById('currPickMirror'); //显示选中镜像元素
  const currPickPeople = document.getElementById('currPickPeople'); //显示选中人数元素
  let isProgrammaticClick = false; // 用来判断是否是程序触发的点击
  let currPickCycle = 1; //已选周期
  let deratePrice = 0; //优惠码减免金额
  let pickGameItem = {}; //选中的游戏列表项
  let pickMirrorItem = {}; // 选中的镜像列表项
  let pickPeopleItem = {}; // 选中的人数列表项
  let isUpIp = 0; //是否升级独立ip，0未选择，1升级，2不升级
  let paymentType = ''; //wxPay(微信支付),aliPay（支付宝支付）,balancePay（余额支付）
  // 监听滚动事件
  window.addEventListener('scroll', () => {
    if (window.scrollY > 100) {
      // 超过100px时隐藏滚动条
      scrollableDiv.classList.add('hide-scrollbar');
      scrollableDiv.classList.remove('show-scrollbar');
    } else {
      // 小于100px时显示滚动条
      scrollableDiv.classList.add('show-scrollbar');
      scrollableDiv.classList.remove('hide-scrollbar');
    }
  });
  function showMessage({ msg, duration = 2000, position = 'top-center', type = 'success' }) {
    // 获取提示框容器
    const container = document.getElementById('message-container');
    const successMessage = document.getElementById('success-message');
    const infoMessage = document.getElementById('info-message');
    const warningMessage = document.getElementById('warning-message');
    const errorMessage = document.getElementById('error-message');

    // 默认不显示提示框
    container.style.display = 'block';

    // 重置所有消息框的显示状态
    successMessage.classList.remove('show');
    infoMessage.classList.remove('show');
    warningMessage.classList.remove('show');
    errorMessage.classList.remove('show');

    // 根据类型显示对应的消息框
    let messageElement;
    if (type === 'success') {
      messageElement = successMessage;
      messageElement.querySelector('p').textContent = msg;
    } else if (type === 'info') {
      messageElement = infoMessage;
      messageElement.querySelector('p').textContent = msg;
    } else if (type === 'warning') {
      messageElement = warningMessage;
      messageElement.querySelector('p').textContent = msg;
    } else if (type === 'error') {
      messageElement = errorMessage;
      messageElement.querySelector('p').textContent = msg;
    }

    // 显示消息框并添加动画效果
    setTimeout(() => {
      messageElement.classList.add('show');
    }, 100);

    // 消息框持续时间后移除
    setTimeout(() => {
      messageElement.classList.remove('show');
      setTimeout(() => {
        container.style.display = 'none'; // 隐藏消息容器
      }, 300); // 等待动画完成
    }, duration);
  }
  //点击退出登录
  document.getElementById('logout').addEventListener('click', function () {
    showMessage({
      msg: '退出登陆成功！',
      duration: 3000,
      type: 'success',
    });
    location.reload();
  });
  // 获取所有支付方式元素
  const paymentMethods = document.querySelectorAll('.payment-method');

  // 为每个支付方式添加点击事件
  paymentMethods.forEach((item) => {
    item.addEventListener('click', (e) => {
      // console.log(e.target.dataset.paytype,'444')
      paymentType = e.target.dataset.paytype; //保存支付方式
      // 移除所有支付方式的 selectPay 类和勾选图片
      paymentMethods.forEach((payment) => {
        payment.classList.remove('selectPay'); // 移除 selectPay 类
        const img = payment.querySelector('.isselect'); // 获取勾选图片
        img.src = '/assets/images/no_select_pay_type.svg'; // 恢复未选中状态的勾选图片
      });

      // 给当前点击的支付方式添加 selectPay 类并更改勾选图片
      item.classList.add('selectPay'); // 为当前选中的支付方式添加 selectPay 类
      const selectedImg = item.querySelector('.isselect');
      selectedImg.src = '/assets/images/select_pay_type.svg'; // 设置选中状态的勾选图片
    });
  });

  //游戏项选中部分

  const gameItems = document.querySelectorAll('.game-item'); //获取游戏列表
  const cardContainer = document.querySelector('.card-stack-container');
  gameItems.forEach((item, itemIndex) => {
    item.addEventListener('click', (e) => {
      const gameId = e.currentTarget.dataset.id;
      const targetCard = document.querySelector(`[data-id="${gameId}"]`);
      console.log(gameId, '已选');
      pickGameItem = gameList.filter((i) => i.id == gameId)[0];
      console.log('已选游戏', pickGameItem);
      currPickGame.textContent = pickGameItem.name;
      currPickBigImg.src = pickGameItem.bImage;
      currPickSmallImg.src = pickGameItem.sImage;
      calculatedAmount(); //计算金额
      // 移动卡片到顶层
      if (targetCard) {
        // 更新 z-index 和位置
        const currentZIndex = parseInt(window.getComputedStyle(targetCard).zIndex) || 0;
        targetCard.style.zIndex = gameList.length + currentZIndex;
        targetCard.style.transform = 'translateY(0) scale(1)'; // 重置目标卡片的大小和位置

        // 更新其他卡片位置和大小
        cardContainer.querySelectorAll('.card-stack').forEach((card, index) => {
          if (card !== targetCard) {
            const scale = 1 - (index + 1) * 0.05; // 每层缩小 0.05
            const offsetY = (index + 1) * 20; // 每层向下偏移 20px
            card.style.transform = `translateY(${offsetY}px) scale(${scale})`;
            card.style.zIndex = gameList.length - index;
          }
        });
      }

      gameItems.forEach((i) => {
        i.classList.remove('selected');
        i.style.borderColor = '#B0A29E';
        i.style.borderImage = 'none'; // 移除之前的渐变边框
      });

      e.currentTarget.classList.add('selected');
      e.currentTarget.style.borderColor = 'transparent'; // 设置透明的边框颜色
      e.currentTarget.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1'; // 设置渐变边框

      const targetSection = document.querySelector(item.getAttribute('data-target'));
      // 如果是程序触发的点击事件，则跳过滚动操作
      if (isProgrammaticClick) {
        isProgrammaticClick = false; // 重置标志
        return; // 跳过滚动到镜像区域
      }

      if (targetSection) {
        // 先滚动到镜像区域
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

        const section1Element = document.getElementById('section1');
        console.log(section1Element.offsetHeight);
        // 添加偏移量 (向上滚动一定的距离)
        setTimeout(() => {
          window.scrollBy(0, -section1Element.offsetHeight); // 向上偏移 50px
        }, 0);
      }
    });

    // 循环完毕后，默认触发第一个卡片的点击事件
    if (itemIndex === gameItems.length - 1) {
      isProgrammaticClick = true; // 标记为程序触发
      gameItems[0].click(); // 触发第一个卡片的点击事件
    }
  });

  // 镜像项选中部分

  const mirrorItems = document.querySelectorAll('.mirror-item'); // 获取镜像列表
  mirrorItems.forEach((item) => {
    item.addEventListener('click', (e) => {
      let currMirrorId = e.currentTarget.dataset.id; // 获取当前点击项的 ID
      pickMirrorItem = mirrorList.filter((i) => i.id == currMirrorId)[0]; // 过滤出选中的镜像项
      console.log('已选镜像', pickMirrorItem); // 打印已选镜像
      calculatedAmount(); //计算金额
      currPickMirror.textContent = pickMirrorItem.name;
      // 处理选中状态
      mirrorItems.forEach((i) => {
        i.classList.remove('selected');
        i.style.borderColor = '#B0A29E';
        i.style.borderImage = 'none'; // 移除之前的渐变边框
      });

      e.currentTarget.classList.add('selected');
      e.currentTarget.style.borderColor = 'transparent'; // 设置透明的边框颜色
      e.currentTarget.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1'; // 设置渐变边框

      const targetSection = document.querySelector(item.getAttribute('data-target'));

      if (targetSection) {
        // 先滚动到人数区域
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        const section2Element = document.getElementById('section2');
        const section1Element = document.getElementById('section1');
        console.log(section2Element.offsetHeight);
        // 添加偏移量 (向上滚动一定的距离)
        setTimeout(() => {
          window.scrollBy(0, -(section2Element.offsetHeight + section1Element.offsetHeight)); // 向上偏移 50px
        }, 0);
      }
    });
  });

  // 人数项选中部分

  const peopleItems = document.querySelectorAll('.people-item'); // 获取人数列表
  peopleItems.forEach((item) => {
    item.addEventListener('click', (e) => {
      pickPeopleItem = peopleList.filter((i) => i.id == e.currentTarget.dataset.id)[0]; // 过滤出选中的人数项
      console.log('已选人数', pickPeopleItem); // 打印已选人数
      calculatedAmount(); //计算金额
      currPickPeople.textContent = pickPeopleItem.num + '人';
      // 处理选中状态
      peopleItems.forEach((i) => {
        i.classList.remove('selected');
        i.style.borderColor = '#B0A29E';
        i.style.borderImage = 'none'; // 移除之前的渐变边框
      });
      e.currentTarget.classList.add('selected');
      e.currentTarget.style.borderColor = 'transparent'; // 设置透明的边框颜色
      e.currentTarget.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1'; // 设置渐变边框
      morePeopleItem.style.borderImage = 'linear-gradient(to right, #40C6FF00 0%, #1C80EB00 100%) 1'; // 设置渐变边框
      morePeopleItem.style.borderColor = '#B0A29E'; //
      const targetSection = document.querySelector('#section4');
      if (targetSection) {
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });

  //选择更多套餐
  const selectElement = document.getElementById('teamSizeSelect');
  const morePeopleItem = document.querySelector('.more-people-item');

  // 更新价格显示
  function updatePriceDisplay(selectedNum) {
    const selectedItem = morePeopleList.find((item) => item.num === Number(selectedNum));
    pickPeopleItem = selectedItem;
    morePeopleItem.classList.add('selected');
    morePeopleItem.style.borderColor = 'transparent'; // 设置透明的边框颜色
    morePeopleItem.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1'; // 设置渐变边框
    peopleItems.forEach((i) => {
      i.classList.remove('selected');
      i.style.borderColor = '#B0A29E';
      i.style.borderImage = 'none'; // 移除之前的渐变边框
    });
    console.log(pickPeopleItem, '已选更多套餐');
    currPickPeople.textContent = pickPeopleItem.num + '人';
  }

  // 添加选中事件监听
  selectElement.addEventListener('change', function (e) {
    // 阻止事件冒泡到父元素
    e.stopPropagation();
    const selectedNum = this.value;
    updatePriceDisplay(selectedNum);
  });

  // 独立IP逻辑
  const upIpAddr = document.getElementById('upIpAddr'); //升级独立IP元素
  const noUpIpAddr = document.getElementById('noUpIpAddr'); //不升级独立IP元素

  // 点击升级独立IP
  upIpAddr.addEventListener('click', function (e) {
    isUpIp = 1;
    console.log('升级独立IP', isUpIp);
    upIpAddr.classList.add('selected');
    upIpAddr.style.borderStyle = 'solid'; // 设置为 solid
    upIpAddr.style.borderWidth = '0.104vw'; // 确保边框宽度大于 0
    upIpAddr.style.borderColor = 'transparent';
    upIpAddr.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1';

    // 清除不升级独立IP的样式
    noUpIpAddr.classList.remove('selected');
    noUpIpAddr.style.borderImage = ''; // 清除渐变边框
    noUpIpAddr.style.border = '0.052vw solid #474141FF';
    const targetSection = document.querySelector('#section5');
    if (targetSection) {
      targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });

  noUpIpAddr.addEventListener('click', function (e) {
    isUpIp = 2;
    console.log('不升级独立IP', isUpIp);
    noUpIpAddr.classList.add('selected');
    noUpIpAddr.style.borderStyle = 'solid'; // 设置为 solid
    noUpIpAddr.style.borderWidth = '0.104vw'; // 确保边框宽度大于 0
    noUpIpAddr.style.borderColor = 'transparent';
    noUpIpAddr.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1';
    // 清除升级独立IP的样式
    upIpAddr.classList.remove('selected');
    upIpAddr.style.borderImage = ''; // 清除渐变边框
    upIpAddr.style.border = '0.052vw solid #474141FF';
    const targetSection = document.querySelector('#section5');
    if (targetSection) {
      targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
  // 获取下拉框和选项列表
  const customSelect = document.querySelector('.custom-select');
  const optionsList = document.querySelector('.options-list');
  const selectedOption = document.querySelector('#moreSelete');

  // 切换显示/隐藏下拉菜单
  customSelect.addEventListener('click', function (e) {
    e.stopPropagation(); // 阻止事件冒泡，防止触发外部点击事件
    this.classList.toggle('open');
    optionsList.style.display = optionsList.style.display === 'block' ? 'none' : 'block';
  });

  // 使用事件委托绑定点击选项事件
  optionsList.addEventListener('click', function (e) {
    // 确保点击的是选项项（li）
    const target = e.target.closest('.option-item'); // 确保点击文字或其他部分都能获取到对应的 li
    if (target) {
      console.log(target.dataset.id);
      pickPeopleItem = morePeopleList.filter((i) => i.id == target.dataset.id)[0]; // 过滤出选中的人数项
      console.log('已选更多套餐人数', pickPeopleItem); // 打印已选人数
      calculatedAmount(); //计算金额
      currPickPeople.textContent = pickPeopleItem.num + '人';
      selectedOption.textContent = `${target.dataset.num}人 - ${target.dataset.price}元/月`; // 更新选择内容
      optionsList.style.display = 'none'; // 关闭下拉框
      customSelect.classList.remove('open'); // 移除打开样式
      const targetSection = document.querySelector('#section4');
      morePeopleItem.classList.add('selected');
      morePeopleItem.style.borderColor = 'transparent'; // 设置透明的边框颜色
      morePeopleItem.style.borderImage = 'linear-gradient(to right, #40C6FF 0%, #1C80EB 100%) 1'; // 设置渐变边框
      peopleItems.forEach((i) => {
        i.classList.remove('selected');
        i.style.borderColor = '#B0A29E';
        i.style.borderImage = 'none'; // 移除之前的渐变边框
      });

      if (targetSection) {
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }
  });

  // 如果点击下拉外部区域关闭下拉框
  document.addEventListener('click', function (e) {
    if (!customSelect.contains(e.target)) {
      optionsList.style.display = 'none';
      customSelect.classList.remove('open');
    }
  });

  document.getElementById('verifPpromoCode').addEventListener('click', function () {
    // 获取输入框的值
    const promoCodeValue = document.getElementById('promoCode').value.trim();
    console.log(promoCodeValue);
    // 简单验证：检查输入框是否为空
    if (promoCodeValue == '') {
      showMessage({
        msg: '优惠码不能为空',
        duration: 3000,
        type: 'warning',
      });
      return;
    }

    const myHeaders = new Headers();
    myHeaders.append('User-Agent', 'Apifox/1.0.0 (https://apifox.com)');
    myHeaders.append('Content-Type', 'application/json');
    myHeaders.append('Accept', '*/*');
    myHeaders.append('Host', 'apifoxmock.com');
    myHeaders.append('Connection', 'keep-alive');

    const raw = JSON.stringify({
      promoCode: promoCodeValue,
    });

    const requestOptions = {
      method: 'POST',
      headers: myHeaders,
      body: raw,
      redirect: 'follow',
    };

    fetch('https://apifoxmock.com/m1/5804244-5489264-default/verifPpromoCode', requestOptions)
      .then((response) => response.text())
      .then((result) => {
        console.log(JSON.parse(result));
        const { code, msg, derate } = JSON.parse(result);
        if (code == 200) {
          showMessage({
            msg: msg,
            duration: 3000,
            type: 'success',
          });
          deratePrice = derate;
        } else {
          showMessage({
            msg: msg + ',已清空无效优惠码',
            duration: 3000,
            type: 'error',
          });
          deratePrice = 0;
          document.getElementById('promoCode').value = '';
        }
        calculatedAmount(); //计算金额
      })
      .catch((error) => console.log('error', error));
  });

  // 获取相关元素
  const dropdown = document.querySelector('.dropdown');
  const dropdownMenu = document.getElementById('dropdownMenu');
  const selectedPeriod = document.getElementById('selectedPeriod');

  // 监听下拉框点击
  dropdown.addEventListener('click', (event) => {
    // 阻止事件冒泡，防止点击其他地方时关闭菜单
    event.stopPropagation();
    // 切换下拉菜单的显示状态
    if (dropdownMenu.style.display === 'none' || dropdownMenu.style.display === '') {
      dropdownMenu.style.display = 'block';
      // 使用 Tailwind 的过渡动画
      setTimeout(() => {
        dropdownMenu.classList.remove('opacity-0', 'scale-95');
        dropdownMenu.classList.add('opacity-100', 'scale-100');
      }, 10); // 延迟应用过渡效果
    } else {
      // 隐藏下拉菜单并恢复初始状态
      dropdownMenu.classList.remove('opacity-100', 'scale-100');
      dropdownMenu.classList.add('opacity-0', 'scale-95');
      setTimeout(() => {
        dropdownMenu.style.display = 'none';
      }, 300); // 与动画时长一致，确保在过渡后隐藏
    }
  });

  // 监听每个下拉选项的点击
  const items = document.querySelectorAll('.dropdown-item');
  items.forEach((item) => {
    item.addEventListener('click', (e) => {
      // 更新选择的周期
      console.log(e.target.dataset.cycle);
      currPickCycle = e.target.dataset.cycle;
      selectedPeriod.textContent = e.target.textContent;
      console.log(currPickCycle, '已选周期');
      calculatedAmount(); //计算金额
      // 隐藏下拉菜单
      dropdownMenu.classList.remove('opacity-100', 'scale-100');
      dropdownMenu.classList.add('opacity-0', 'scale-95');
      setTimeout(() => {
        dropdownMenu.style.display = 'none';
      }, 300); // 与动画时长一致，确保在过渡后隐藏
    });
  });

  // 点击其他区域时隐藏下拉菜单
  document.addEventListener('click', () => {
    dropdownMenu.classList.remove('opacity-100', 'scale-100');
    dropdownMenu.classList.add('opacity-0', 'scale-95');
    setTimeout(() => {
      dropdownMenu.style.display = 'none';
    }, 300); // 与动画时长一致，确保在过渡后隐藏
  });
  // 计算金额的方法
  function calculatedAmount() {
    // 打印各项数据
    console.log(pickGameItem, '游戏');
    console.log(pickMirrorItem, '镜像');
    console.log(pickPeopleItem, '人数');

    const payAmount = document.querySelector('#payAmount');
    let amount = 0;

    // 处理可能不存在的值，若不存在则默认为0
    const gamePrice = pickGameItem?.price || 0;
    const mirrorPrice = pickMirrorItem?.price || 0;
    const peoplePrice = pickPeopleItem?.price || 0;

    // 计算金额
    amount = (gamePrice + mirrorPrice + peoplePrice) * Number(currPickCycle) - deratePrice;

    // 更新支付金额
    payAmount.textContent = amount;
  }
  //点击支付按钮

  document.querySelector('#paymentBtn').addEventListener('click', function () {
    // 点击按钮时的操作
    // console.log('支付按钮被点击了');
    // 在这里添加支付逻辑
    if (!pickGameItem.id) {
      return showMessage({
        msg: '请选择要开服的游戏',
        duration: 3000,
        type: 'warning',
      });
    }
    if (!pickMirrorItem.id) {
      return showMessage({
        msg: '请选择要开服的游戏的镜像',
        duration: 3000,
        type: 'warning',
      });
    }
    if (!pickPeopleItem.id) {
      return showMessage({
        msg: '请选择要开服的游戏的人数',
        duration: 3000,
        type: 'warning',
      });
    }
    if (isUpIp == 0) {
      return showMessage({
        msg: '请选择NAT或升级独立IP模式',
        duration: 3000,
        type: 'warning',
      });
    }
    if (!paymentType) {
      return showMessage({
        msg: '请选择您的支付方式',
        duration: 3000,
        type: 'warning',
      });
    }
    if (paymentType == 'wxPay') {
      showMessage({
        msg: '将使用微信支付进行支付。。。',
        duration: 3000,
        type: 'success',
      });
    }
    if (paymentType == 'aliPay') {
      showMessage({
        msg: '将使用支付宝支付进行支付。。。',
        duration: 3000,
        type: 'success',
      });
    }
    if (paymentType == 'balancePay') {
      showMessage({
        msg: '将使用余额支付进行支付。。。',
        duration: 3000,
        type: 'success',
      });
    }
  });
</script>

<style>
  /* .menu::before {
  content: "";
  position: absolute;
  top: -5vw;  
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 5vw solid transparent;
  border-right: 5vw solid transparent;
  border-bottom: 5vw solid rgba(0, 0, 0, 0.4); 
} */
  .menu::before {
    content: '';
    position: absolute;
    top: -1.8vw; /* 伪元素偏移的距离 */
    left: 50%;
    transform: translateX(-50%);
    width: 10vw; /* 设置矩形的宽度 */
    height: 2vw; /* 设置矩形的高度 */
    background-color: rgba(0, 0, 0, 0); /* 菜单下方的矩形背景颜色 */
  }

  /* 选择周期下拉样式 */

  .dropdown-menu {
    position: absolute;
    top: 100%; /* 保证下拉菜单位于下方 */
    left: 0; /* 确保下拉菜单与父元素对齐 */
    width: 100%; /* 使下拉菜单宽度与父元素相同 */
    display: none; /* 默认隐藏 */
    border-radius: 0.2vw;
  }

  /* 下拉项样式 */
  .dropdown-item {
    padding: 0.5vw;
    font-size: 0.833vw;
    color: white;
    cursor: pointer;
    text-align: center;
  }

  .dropdown-item:hover {
    background-color: #61504e;
  }

  /* 选择支付方式样式 */
  .selectPay {
    border-radius: 0.26vw;
    background: rgba(42, 130, 228, 0.1);
    border: 0.052vw solid rgba(42, 130, 228, 1);
  }

  .custom-select-wrapper {
    position: relative;
    display: inline-block;
    width: 5.2vw; /* 根据需要调整宽度 */
  }

  .custom-select {
    position: relative;
    padding: 10px;
    cursor: pointer;
    border-radius: 0.208vw;
    z-index: 99999;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    min-width: 5.2vw;
    padding: 0.2vw 0vw;
    border-radius: 0.26vw;
    background-color: #ffffff00;
    cursor: pointer;
    font-size: 0.73vw;
    color: #fff;
    width: fit-content;
  }

  .selected-option {
    display: flex;
    border: none;
  }

  .options-list {
    display: none; /* 默认隐藏 */
    position: absolute;
    width: 100%;
    top: 100%;
    left: 0;
    background-color: #2c2c2c;
    z-index: 1;
    list-style: none;
    padding: 0;
    margin: 0;
    border-radius: 0.208vw;
  }

  .option-item {
    width: 5.2vw;
    padding: 0.52vw;
    cursor: pointer;
    transition: background-color 0.3s ease;
    font-size: 0.625vw;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .option-item:hover {
    background-color: rgba(255, 255, 255, 0.18); /* #FFFFFF30 背景 */
  }

  /* 显示选项 */
  .custom-select.open .options-list {
    display: block;
  }

  .hide-scrollbar {
    /* overflow: hidden; */
    display: none;
  }
  .show-scrollbar {
    display: flex;
  }
  .control-btn:hover {
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 0.26vw;
  }
  .card-stack {
    position: relative;
    width: 62.5vw;
    height: 26.3vw;
  }

  .card {
    position: absolute;
    width: 100%;
    height: 180px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    color: #333;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  /* 更多套餐 */
  .select-container {
    position: relative;
    width: fit-content;
  }

  /* 隐藏滚动条 */
  .custom-scrollbar-hidden {
    ::-webkit-scrollbar {
      display: none;
    }

    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .custom-scrollbar-hidden {
    scroll-behavior: smooth;
  }
  .rotate-add-icon {
    transition: transform 1s ease-in-out; /* 1秒过渡效果 */
  }

  .rotate-add-icon:hover {
    transform: rotate(90deg); /* hover时顺时针旋转一圈 */
  }

  .rotate-add-icon:not(:hover) {
    transform: rotate(-90deg); /* 离开时逆时针旋转回原位 */
  }
  .message {
    top: 10px;
    position: fixed;
    left: 50%;
    transform: translateX(-50%) translateY(-20px); /* 使消息水平居中 */
    opacity: 0;
    transition:
      transform 0.3s ease-out,
      opacity 0.3s ease-out;
    max-width: 90%; /* 限制最大宽度 */
    z-index: 99999;
  }

  .message.show {
    transform: translateX(-50%) translateY(0); /* 显示时动画效果 */
    opacity: 1;
  }

  #message-container {
    top: 20px; /* 从顶部开始 */
    width: 100%; /* 容器宽度100% */
    z-index: 9999; /* 确保在最上层 */
  }
  #success-message svg {
    fill: green;
  }

  #info-message svg {
    fill: blue;
  }

  #warning-message svg {
    fill: yellow;
  }

  #error-message svg {
    fill: red;
  }
</style>
